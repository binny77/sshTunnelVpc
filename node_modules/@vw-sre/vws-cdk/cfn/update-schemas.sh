#!/usr/bin/env bash
export AWS_REGION=eu-west-1

dir="$PWD"
types="$dir"/types.json
schemas="$dir"/schemas

aws cloudformation list-types > "$types"

jq -r '.TypeSummaries[]|[.Type, .TypeName] | @tsv' "$types" |
  while IFS=$'\t' read -r type typeName; do
    aws cloudformation describe-type --type "$type" --type-name "$typeName" | jq '.Schema | fromjson' > "$schemas"/"$type"/"$typeName".json
  done
